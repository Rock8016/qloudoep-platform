package com.hrjk.fin.demo.security;

import java.io.Serializable;
import java.time.Instant;
import java.util.Date;
import java.util.function.Function;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.security.oauth2.jwt.ReactiveJwtDecoder;
import org.springframework.security.oauth2.jwt.ReactiveJwtDecoders;
import org.springframework.stereotype.Component;

// @Component
public class JwtTokenUtil implements Serializable {

    @Value("${spring.security.oauth2.resourceserver.jwt.issuer-uri}")
	String issuerUri;

    ReactiveJwtDecoder jwtDecoder = ReactiveJwtDecoders.fromIssuerLocation(issuerUri);
 
    public Boolean validateToken(String token) {
       Jwt jwt =  jwtDecoder.decode(token).block();      
       jwt.getClaimAsString("token");
       return  jwt.getExpiresAt().isAfter(Instant.now());
    }

}